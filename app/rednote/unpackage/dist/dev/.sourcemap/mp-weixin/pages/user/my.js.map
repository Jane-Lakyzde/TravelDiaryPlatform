{"version":3,"file":"my.js","sources":["pages/user/my.vue","../../../../biji/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9teS52dWU"],"sourcesContent":["<template>\r\n  <view class=\"home\">\r\n    <!-- 顶部栏 -->\r\n    <view class=\"header\">\r\n      <text class=\"username\">{{ userInfo.email }}</text>\r\n      <view class=\"header-icons\">\r\n        <text class=\"iconfont icon-1\"></text>\r\n        <text class=\"iconfont icon-2\"></text>\r\n        <text class=\"iconfont icon-3\" @tap=\"handleLogout\"></text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 头像与统计 -->\r\n    <view class=\"profile-row\">\r\n      <view class=\"avatar-box\" @tap=\"chooseAvatar\">\r\n        <image class=\"avatar\" :src=\"userInfo.avatar || '/static/images/touxiang.jpg'\" />\r\n      </view>\r\n      <view class=\"stats\">\r\n        <view class=\"stat\"><text class=\"stat-num\">{{ userInfo.posts || 0 }}</text><text class=\"stat-label\">帖子</text></view>\r\n        <view class=\"stat\"><text class=\"stat-num\">{{ userInfo.followers || 0 }}</text><text class=\"stat-label\">粉丝</text></view>\r\n        <view class=\"stat\"><text class=\"stat-num\">{{ userInfo.following || 0 }}</text><text class=\"stat-label\">关注</text></view>\r\n      </view>\r\n    </view>\r\n    <view class=\"nickname\">{{ userInfo.username }}</view>\r\n    <view class=\"bio\">{{ userInfo.bio || '这个人很懒，什么都没写~' }}</view>\r\n    <view class=\"btn-row\">\r\n      <button class=\"btn-edit\" @tap=\"handleEditProfile\">编辑主页</button>\r\n      <button class=\"btn-share\">分享主页</button>\r\n      <button class=\"btn-add\" @tap=\"() => uni.navigateTo({ url: '/pages/user/post' })\">\r\n        <text class=\"iconfont icon-add\"></text>\r\n      </button>\r\n    </view>\r\n\r\n    <!-- 我的帖子/视频 tab -->\r\n    <view class=\"tab-row\">\r\n      <view\r\n        class=\"tab-btn\"\r\n        :class=\"{ active: activeTab === 'post' }\"\r\n        @tap=\"activeTab = 'post'\"\r\n      >\r\n        <text class=\"iconfont icon-tupian\"></text>\r\n      </view>\r\n      <view\r\n        class=\"tab-btn\"\r\n        :class=\"{ active: activeTab === 'video' }\"\r\n        @tap=\"activeTab = 'video'\"\r\n      >\r\n        <text class=\"iconfont icon-shipin\"></text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 九宫格内容 -->\r\n    <view v-if=\"activeTab === 'post'\" class=\"posts-grid\">\r\n      <image\r\n        v-for=\"post in myPosts\"\r\n        :key=\"post.id\"\r\n        :src=\"post.images[0]\"\r\n        class=\"post-img\"\r\n        @tap=\"viewPostDetail(post.id)\"\r\n      />\r\n    </view>\r\n    <view v-else class=\"posts-grid\">\r\n      <view\r\n        v-for=\"video in myVideos\"\r\n        :key=\"video.id\"\r\n        class=\"post-img video-thumb\"\r\n      >\r\n        <image :src=\"video.cover\" class=\"video-cover\" />\r\n        <view class=\"video-icon\"><text class=\"iconfont\">▶</text></view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useUserStore } from '@/store/modules/user'\r\nimport { usePostStore } from '@/store/modules/post'\r\n\r\nconst userStore = useUserStore()\r\nconst postStore = usePostStore()\r\nconst activeTab = ref('post')\r\n\r\n// 从 Pinia 获取用户信息\r\nconst userInfo = computed(() => userStore.getUserInfo)\r\n\r\n// 获取我的帖子列表\r\nconst myPosts = computed(() => {\r\n  return postStore.posts.filter(post => post.author.username === userInfo.value.username)\r\n})\r\n\r\n// 编辑主页\r\nconst handleEditProfile = () => {\r\n  uni.showActionSheet({\r\n    itemList: ['编辑个人资料', '修改头像'],\r\n    success: (res) => {\r\n      switch (res.tapIndex) {\r\n        case 0:\r\n          uni.navigateTo({ url: '/pages/change/editprofile' })\r\n          break\r\n        case 1:\r\n          chooseAvatar()\r\n          break\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 选择头像\r\nconst chooseAvatar = () => {\r\n  uni.chooseImage({\r\n    count: 1,\r\n    sizeType: ['compressed'],\r\n    sourceType: ['album', 'camera'],\r\n    success: (res) => {\r\n      const tempFilePath = res.tempFilePaths[0]\r\n      // 更新用户头像\r\n      userStore.updateUserInfo({\r\n        ...userInfo.value,\r\n        avatar: tempFilePath\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n// 退出登录方法\r\nconst handleLogout = () => {\r\n  uni.showModal({\r\n    title: '提示',\r\n    content: '确定要退出登录吗？',\r\n    success: (res) => {\r\n      if (res.confirm) {\r\n        userStore.logout()\r\n        uni.reLaunch({\r\n          url: '/pages/login/login'\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 查看帖子详情\r\nconst viewPostDetail = (postId) => {\r\n  uni.navigateTo({\r\n    url: `/pages/post/detail?id=${postId}`\r\n  })\r\n}\r\n</script>\r\n\r\n<style>\r\n.home { background: #fff; min-height: 100vh; }\r\n.header {\r\n  display: flex; justify-content: space-between; align-items: center;\r\n  padding: 30rpx 30rpx 0 30rpx;\r\n}\r\n.username { font-size: 36rpx; font-weight: bold; }\r\n.header-icons text { font-size: 40rpx; margin-left: 30rpx; }\r\n.profile-row { display: flex; align-items: center; padding: 30rpx; }\r\n.avatar-box { position: relative; }\r\n.avatar { width: 140rpx; height: 140rpx; border-radius: 50%; }\r\n.avatar-note {\r\n  position: absolute; left: 0; top: 0; background: #fff; color: #888;\r\n  font-size: 22rpx; border-radius: 20rpx; padding: 4rpx 16rpx;\r\n}\r\n.stats { display: flex; margin-left: 60rpx; }\r\n.stat { align-items: center; margin-right: 50rpx; }\r\n.stat-num { font-size: 36rpx; font-weight: bold; text-align: center; }\r\n.stat-label { font-size: 24rpx; color: #888; text-align: center; }\r\n.nickname { font-size: 30rpx; font-weight: bold; margin-left: 30rpx; }\r\n.bio { font-size: 26rpx; color: #666; margin-left: 30rpx; margin-bottom: 20rpx; }\r\n.btn-row { display: flex; margin: 0 30rpx 20rpx 30rpx; }\r\n.btn-edit, .btn-share {\r\n  flex: 1; margin-right: 20rpx; background: #f5f5f5; color: #222; border-radius: 16rpx;\r\n  font-size: 28rpx; height: 60rpx; line-height: 60rpx;\r\n}\r\n.btn-share { margin-right: 0; }\r\n.btn-add { width: 60rpx; height: 60rpx; border-radius: 50%; background: #f5f5f5; margin-left: 20rpx; }\r\n\r\n/* tab切换区 */\r\n.tab-row {\r\n  display: flex;\r\n  border-top: 1rpx solid #eee;\r\n  border-bottom: 1rpx solid #eee;\r\n  margin-bottom: 10rpx;\r\n  background: #fff;\r\n}\r\n.tab-btn {\r\n  flex: 1;\r\n  text-align: center;\r\n  padding: 20rpx 0;\r\n  font-size: 28rpx;\r\n  color: #888;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n}\r\n.tab-btn.active {\r\n  color: #222;\r\n  font-weight: bold;\r\n}\r\n.tab-btn.active::after {\r\n  content: '';\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 40rpx;\r\n  height: 4rpx;\r\n  background-color: #222;\r\n  border-radius: 2rpx;\r\n}\r\n\r\n/* 九宫格内容 */\r\n.posts-grid {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin: 0 10rpx 100rpx 10rpx;\r\n}\r\n.post-img {\r\n  width: 25%;\r\n  height: 25%;\r\n  aspect-ratio: 1/1;\r\n  margin: 1%;\r\n  border-radius: 8rpx;\r\n  object-fit: cover;\r\n  background: #eee;\r\n  position: relative;\r\n}\r\n.video-thumb .video-cover {\r\n  width: 25%;\r\n  height: 25%;\r\n  border-radius: 8rpx;\r\n  object-fit: cover;\r\n}\r\n.video-thumb .video-icon {\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  font-size: 48rpx;\r\n  color: #fff;\r\n  background: rgba(0,0,0,0.3);\r\n  border-radius: 50%;\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n/* 图标字体 */\r\n@font-face {\r\n  font-family: 'iconfont';\r\n  src: url('/static/fonts/iconfont.ttf') format('woff2');\r\n}\r\n.iconfont {\r\n  font-family: 'iconfont';\r\n  font-size: 32rpx;\r\n}\r\n.icon-tupian ::before{ content: '\\e609'}\r\n.icon-shipin ::before{ content: '\\e64a'}\r\n</style>","import MiniProgramPage from 'D:/Git clone/TravelDiaryPlatform/app/rednote/pages/user/my.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","usePostStore","ref","computed","uni","MiniProgramPage"],"mappings":";;;;;;;AA+EA,UAAM,YAAYA,mBAAAA,aAAc;AAChC,UAAM,YAAYC,mBAAAA,aAAc;AAChC,UAAM,YAAYC,cAAG,IAAC,MAAM;AAG5B,UAAM,WAAWC,cAAQ,SAAC,MAAM,UAAU,WAAW;AAGrD,UAAM,UAAUA,cAAQ,SAAC,MAAM;AAC7B,aAAO,UAAU,MAAM,OAAO,UAAQ,KAAK,OAAO,aAAa,SAAS,MAAM,QAAQ;AAAA,IACxF,CAAC;AAGD,UAAM,oBAAoB,MAAM;AAC9BC,oBAAAA,MAAI,gBAAgB;AAAA,QAClB,UAAU,CAAC,UAAU,MAAM;AAAA,QAC3B,SAAS,CAAC,QAAQ;AAChB,kBAAQ,IAAI,UAAQ;AAAA,YAClB,KAAK;AACHA,4BAAAA,MAAI,WAAW,EAAE,KAAK,4BAA2B,CAAE;AACnD;AAAA,YACF,KAAK;AACH,2BAAc;AACd;AAAA,UACH;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,QACP,UAAU,CAAC,YAAY;AAAA,QACvB,YAAY,CAAC,SAAS,QAAQ;AAAA,QAC9B,SAAS,CAAC,QAAQ;AAChB,gBAAM,eAAe,IAAI,cAAc,CAAC;AAExC,oBAAU,eAAe;AAAA,YACvB,GAAG,SAAS;AAAA,YACZ,QAAQ;AAAA,UAChB,CAAO;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACf,sBAAU,OAAQ;AAClBA,0BAAAA,MAAI,SAAS;AAAA,cACX,KAAK;AAAA,YACf,CAAS;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,iBAAiB,CAAC,WAAW;AACjCA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,yBAAyB,MAAM;AAAA,MACxC,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjJA,GAAG,WAAWC,SAAe;"}