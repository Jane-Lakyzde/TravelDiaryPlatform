{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\n  <view class=\"login-container\">\n    <!-- 顶部 -->\n    <view class=\"login-header\">\n      <text class=\"iconfont icon-back\">×</text>\n      <text class=\"login-help\" @tap=\"toggleHelp\">遇到问题</text>\n      <view v-if=\"showHelp\" class=\"dropdown-menu\" @tap.stop>\n        <view class=\"dropdown-item\">无法接收验证码</view>\n        <view class=\"dropdown-item\">微信登录失败</view>\n        <view class=\"dropdown-item\">联系客服</view>\n      </view>\n    </view>\n    \n    <!-- LOGO 区域 - 留出空间给图片 -->\n    <view class=\"login-logo\">\n      <image src=\"/static/images/logo.png\" mode=\"aspectFit\" />\n    </view>\n    \n    <!-- 登录按钮区域 -->\n    <view class=\"login-buttons-area\">\n      <!-- 微信一键登录 -->\n      <button class=\"login-btn wx-btn\" @tap=\"wxLogin\">\n        <view class=\"btn-content\">\n          <text class=\"iconfont icon-wechat white-icon\"></text>\n          <text class=\"btn-text\">微信一键登录</text>\n        </view>\n      </button>\n      \n      <!-- 手机号登录 -->\n      <view class=\"login-phone\" @tap=\"goPhoneLogin\">手机号登录</view>\n      \n      <!-- 其它方式登录 -->\n      <view class=\"login-other-title\">其它方式登录</view>\n      <view class=\"login-other-icons\">\n        <view class=\"icon-wrap\" @tap=\"toggleOtherMenu\">\n          <text class=\"iconfont icon-wechat\"></text>\n        </view>\n        <view class=\"icon-wrap\" @tap=\"toggleOtherMenu\">\n          <text class=\"iconfont icon-weibo\"></text>\n        </view>\n        <view class=\"icon-wrap\" @tap=\"toggleOtherMenu\">\n          <text class=\"iconfont icon-qq\"></text>\n        </view>\n        <view v-if=\"showOtherMenu\" class=\"dropdown-menu other-menu\" @tap.stop>\n          <view class=\"dropdown-item\">暂未开通，敬请期待</view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 协议勾选 -->\n    <view class=\"login-protocol\">\n      <text class=\"checkbox\" :class=\"{checked: checked}\" @tap=\"checked = !checked\">\n        <text v-if=\"checked\" class=\"iconfont icon-checked\"></text>\n        <text v-else class=\"iconfont icon-unchecked\"></text>\n      </text>\n      <view class=\"protocol-text\">\n        已阅读并同意\n        <text class=\"link-text\" hover-class=\"link-text-active\" @tap=\"goToAgreement('user-agreement')\">《用户协议》</text>\n        <text class=\"link-text\" hover-class=\"link-text-active\" @tap=\"goToAgreement('privacy-policy')\">《隐私政策》</text>\n        <text class=\"link-text\" hover-class=\"link-text-active\" @tap=\"goToAgreement('buyer-notice')\">《买家须知》</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { login } from '@/api/user' // 假设你有一个用户API模块\n\nconst showHelp = ref(false)\nconst showOtherMenu = ref(false)\nconst checked = ref(false)\nconst loginLoading = ref(false)\n\nconst toggleHelp = () => {\n  showHelp.value = !showHelp.value\n  showOtherMenu.value = false\n}\nconst toggleOtherMenu = () => {\n  showOtherMenu.value = !showOtherMenu.value\n  showHelp.value = false\n}\nconst goPhoneLogin = () => {\n  uni.navigateTo({ url: '/pages/login/phone' })\n}\n\n// 跳转到协议页面\nconst goToAgreement = (type) => {\n  uni.navigateTo({\n    url: `/pages/agreement/${type}`\n  })\n}\n\n// 微信登录方法\nconst wxLogin = () => {\n  // 检查是否同意协议\n  if (!checked.value) {\n    uni.showToast({\n      title: '请先阅读并同意相关协议',\n      icon: 'none'\n    })\n    return\n  }\n  \n  // 显示加载状态\n  loginLoading.value = true\n  \n  // 调用uni-app的登录方法获取code\n  uni.login({\n    provider: 'weixin',\n    success: (res) => {\n      console.log('微信登录成功，获取code：', res.code)\n      // 将code发送到后端\n      login({\n        code: res.code,\n        loginType: 'wechat'\n      }).then(response => {\n        console.log('登录成功', response)\n        // 登录成功后保存token\n        if (response.data && response.data.token) {\n          uni.setStorageSync('token', response.data.token)\n          uni.setStorageSync('userInfo', response.data.userInfo)\n          \n          // 跳转到首页\n          uni.switchTab({\n            url: '/pages/user/home'\n          })\n        }\n      }).catch(error => {\n        console.error('登录失败', error)\n        uni.showToast({\n          title: '登录失败，请重试',\n          icon: 'none'\n        })\n      }).finally(() => {\n        loginLoading.value = false\n      })\n    },\n    fail: (err) => {\n      console.error('微信登录失败', err)\n      uni.showToast({\n        title: '微信登录失败，请重试',\n        icon: 'none'\n      })\n      loginLoading.value = false\n    }\n  })\n}\n</script>\n\n<style>\n@font-face {\n  font-family: 'iconfont';\n  src: url('/static/fonts/iconfont.ttf') format('truetype');\n}\n.iconfont {\n  font-family: 'iconfont';\n  font-size: 32rpx;\n}\n.login-container {\n  min-height: 100vh;\n  width: 750rpx; /* 使用固定宽度750rpx（等于100vw）确保占满屏幕 */\n  background-color: #585965;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  position: relative;\n  overflow: hidden; /* 防止毛玻璃效果溢出 */\n  padding: 0; /* 移除可能的内边距 */\n  margin: 0 -10rpx; /* 向两侧扩展10rpx覆盖可能的白边 */\n  box-sizing: border-box;\n  left: 0; /* 确保左对齐 */\n}\n\npage {\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  overflow-x: hidden;\n  background-color: #585965;\n}\n\n/* 扩展背景色解决白边问题 */\nuni-page-body,\nuni-page-head,\nuni-page,\nuni-page-wrapper {\n  background-color: #585965 !important;\n}\n\n/* 背景装饰 - 增加模糊效果 */\n.login-container::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -10rpx; /* 向左扩展 */\n  right: -10rpx; /* 向右扩展 */\n  bottom: 0;\n  background: radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 60%);\n  z-index: 0;\n}\n\n/* 增加背景淡化模糊层 */\n.login-container::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -10rpx;\n  right: -10rpx;\n  bottom: 0;\n  background-color: rgba(255, 255, 255, 0.03);\n  backdrop-filter: blur(2px);\n  -webkit-backdrop-filter: blur(2px);\n  z-index: 0;\n}\n\n.login-header, .login-logo, .login-buttons-area, .login-protocol {\n  position: relative;\n  z-index: 1;\n  width: 100%;\n}\n\n.login-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: 40rpx 40rpx 0 40rpx;\n  box-sizing: border-box;\n}\n.icon-back {\n  font-size: 48rpx;\n  color: #DB9EA2;\n}\n.login-help {\n  font-size: 28rpx;\n  color: #DB9EA2;\n  position: absolute;\n  right: 60rpx;\n  font-weight: 500;\n  letter-spacing: 0.5px;\n}\n.dropdown-menu {\n  position: absolute;\n  top: 60rpx;\n  right: 0;\n  background: rgba(255, 255, 255, 0.9);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  border-radius: 16rpx;\n  box-shadow: 0 2rpx 12rpx rgba(0,0,0,0.15);\n  z-index: 10;\n  min-width: 220rpx;\n}\n.dropdown-item {\n  padding: 28rpx 40rpx;\n  font-size: 28rpx;\n  color: #333;\n  border-bottom: 1rpx solid rgba(240,240,240,0.5);\n}\n.dropdown-item:last-child { border-bottom: none; }\n\n/* Logo 区域 */\n.login-logo {\n  margin: 80rpx 0;\n  width: 312rpx;  /* 原240rpx的1.3倍 */\n  height: 312rpx;  /* 原240rpx的1.3倍 */\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: transparent;\n  border-radius: 24rpx;\n}\n\n.login-logo image {\n  width: 260rpx;  /* 原200rpx的1.3倍 */\n  height: 260rpx;  /* 原200rpx的1.3倍 */\n  border-radius: 0;\n}\n\n/* 登录按钮区域 */\n.login-buttons-area {\n  padding: 0 40rpx;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 220rpx; /* 增加下移距离 */\n}\n\n/* 微信一键登录按钮 - 改为粉色 */\n.login-btn.wx-btn {\n  width: 90%;\n  height: 90rpx;\n  background: rgba(219, 158, 162, 0.95); /* 粉色按钮 */\n  backdrop-filter: blur(5px); /* 毛玻璃效果 */\n  -webkit-backdrop-filter: blur(5px); /* Safari 支持 */\n  color: #fff;\n  font-size: 32rpx;\n  border-radius: 45rpx; /* 圆角 */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 32rpx;\n  box-shadow: 0 6rpx 16rpx rgba(0, 0, 0, 0.15);\n  border: none;\n  padding: 0;\n}\n\n/* 按钮内容容器 */\n.btn-content {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  position: relative;\n}\n\n/* 微信按钮中的白色图标 */\n.white-icon {\n  color: white !important; /* 使用!important确保覆盖其他样式 */\n  font-size: 40rpx;\n  margin-right: 8rpx;\n  position: relative;\n  left: -20rpx; /* 微调图标位置 */\n}\n\n/* 按钮文本样式 */\n.btn-text {\n  color: white;\n  font-weight: 600;\n  letter-spacing: 2rpx;\n}\n\n/* 手机号登录 */\n.login-phone {\n  color: #DB9EA2;\n  font-size: 32rpx; /* 增大字号 */\n  margin-bottom: 80rpx;\n  text-align: center;\n  font-weight: 500;\n  letter-spacing: 0.5px;\n}\n\n/* 其他登录方式 */\n.login-other-title {\n  color: rgba(219, 158, 162, 0.8);\n  font-size: 28rpx; /* 增大字号 */\n  margin-bottom: 32rpx;\n  margin-top: 20rpx;\n  font-weight: 500;\n  letter-spacing: 0.5px;\n}\n.login-other-icons {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 100rpx; /* 增加图标间距 */\n  margin-bottom: 60rpx;\n  position: relative;\n}\n.icon-wrap {\n  width: 72rpx;\n  height: 72rpx;\n  background: rgba(255, 255, 255, 0.15);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  backdrop-filter: blur(5px);\n  -webkit-backdrop-filter: blur(5px);\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n}\n\n/* 图标样式 */\n.icon-wechat:before { content: '\\e616'; font-size: 40rpx; color: #DB9EA2; }\n.icon-weibo:before { content: '\\e63e'; font-size: 38rpx; color: #DB9EA2; }\n.icon-qq:before { content: '\\e623'; font-size: 38rpx; color: #DB9EA2; }\n\n/* 确保微信登录按钮中的图标为白色 */\n.login-btn.wx-btn .icon-wechat:before {\n  color: white !important; /* 强制为白色 */\n}\n\n.other-menu {\n  left: 0;\n  right: 0;\n  top: 80rpx;\n  min-width: 200rpx;\n  background: rgba(255, 255, 255, 0.9);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n}\n\n/* 协议区域 */\n.login-protocol {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24rpx;\n  margin-top: auto;\n  margin-bottom: 40rpx;\n  width: 90vw;\n  position: absolute;\n  bottom: 0;\n  padding: 20rpx 0;\n  font-weight: 500;\n  letter-spacing: 0.5px;\n}\n.checkbox {\n  width: 36rpx;\n  height: 36rpx;\n  border-radius: 50%;\n  border: 2rpx solid #DB9EA2;\n  margin-right: 16rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: transparent;\n}\n.checkbox.checked {\n  border-color: #DB9EA2;\n  background: #DB9EA2;\n}\n.icon-checked:before { content: '\\2714'; color: #fff; font-size: 28rpx; }\n.icon-unchecked:before { content: ''; }\n.protocol-text {\n  color: #DB9EA2;\n  font-size: 24rpx;\n  font-weight: 500;\n  letter-spacing: 0.5px;\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.link-text {\n  color: #DB9EA2;\n  text-decoration: none;\n  margin: 0 4rpx;\n}\n\n.link-text-active {\n  text-decoration: underline;\n}\n</style>","import MiniProgramPage from 'C:/Users/22533/Desktop/TravelDiaryPlatform/app/rednote/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","login","MiniProgramPage"],"mappings":";;;;;;;AAqEA,UAAM,WAAWA,cAAG,IAAC,KAAK;AAC1B,UAAM,gBAAgBA,cAAG,IAAC,KAAK;AAC/B,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,eAAeA,cAAG,IAAC,KAAK;AAE9B,UAAM,aAAa,MAAM;AACvB,eAAS,QAAQ,CAAC,SAAS;AAC3B,oBAAc,QAAQ;AAAA,IACxB;AACA,UAAM,kBAAkB,MAAM;AAC5B,oBAAc,QAAQ,CAAC,cAAc;AACrC,eAAS,QAAQ;AAAA,IACnB;AACA,UAAM,eAAe,MAAM;AACzBC,oBAAAA,MAAI,WAAW,EAAE,KAAK,qBAAoB,CAAE;AAAA,IAC9C;AAGA,UAAM,gBAAgB,CAAC,SAAS;AAC9BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,oBAAoB,IAAI;AAAA,MACjC,CAAG;AAAA,IACH;AAGA,UAAM,UAAU,MAAM;AAEpB,UAAI,CAAC,QAAQ,OAAO;AAClBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AACD;AAAA,MACD;AAGD,mBAAa,QAAQ;AAGrBA,oBAAAA,MAAI,MAAM;AAAA,QACR,UAAU;AAAA,QACV,SAAS,CAAC,QAAQ;AAChBA,wBAAY,MAAA,MAAA,OAAA,gCAAA,kBAAkB,IAAI,IAAI;AAEtCC,yBAAM;AAAA,YACJ,MAAM,IAAI;AAAA,YACV,WAAW;AAAA,UACnB,CAAO,EAAE,KAAK,cAAY;AAClBD,0BAAAA,MAAA,MAAA,OAAA,gCAAY,QAAQ,QAAQ;AAE5B,gBAAI,SAAS,QAAQ,SAAS,KAAK,OAAO;AACxCA,4BAAAA,MAAI,eAAe,SAAS,SAAS,KAAK,KAAK;AAC/CA,4BAAAA,MAAI,eAAe,YAAY,SAAS,KAAK,QAAQ;AAGrDA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,KAAK;AAAA,cACjB,CAAW;AAAA,YACF;AAAA,UACT,CAAO,EAAE,MAAM,WAAS;AAChBA,0BAAAA,qDAAc,QAAQ,KAAK;AAC3BA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AAAA,UACT,CAAO,EAAE,QAAQ,MAAM;AACf,yBAAa,QAAQ;AAAA,UAC7B,CAAO;AAAA,QACF;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAAA,MAAA,MAAA,SAAA,gCAAc,UAAU,GAAG;AAC3BA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACd,CAAO;AACD,uBAAa,QAAQ;AAAA,QACtB;AAAA,MACL,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClJA,GAAG,WAAWE,SAAe;"}